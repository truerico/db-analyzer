<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="794px" preserveAspectRatio="none" style="width:24462px;height:794px;background:#FFFFFF;" version="1.1" viewBox="0 0 24462 794" width="24462px" zoomAndPan="magnify"><defs/><g><rect fill="#F1F1F1" height="81.9531" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="179" x="10" y="264.5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="42" x="15" y="280.0352">field1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="149" y="280.0352">TSQL</text><line style="stroke:#000000;stroke-width:1.0;" x1="144" x2="144" y1="264.5" y2="284.9883"/><line style="stroke:#000000;stroke-width:1.0;" x1="10" x2="189" y1="284.9883" y2="284.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="90" x="15" y="300.5234">combination</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="35" x="149" y="300.5234">TSQL</text><line style="stroke:#000000;stroke-width:1.0;" x1="144" x2="144" y1="284.9883" y2="305.4766"/><line style="stroke:#000000;stroke-width:1.0;" x1="10" x2="189" y1="305.4766" y2="305.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="121" x="15" y="321.0117">null_distribution</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="149" y="321.0117">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="144" x2="144" y1="305.4766" y2="325.9648"/><line style="stroke:#000000;stroke-width:1.0;" x1="10" x2="189" y1="325.9648" y2="325.9648"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="124" x="15" y="341.5">data_distribution</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="149" y="341.5">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="144" x2="144" y1="325.9648" y2="346.4531"/><rect fill="none" height="81.9531" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="179" x="10" y="264.5"/><rect fill="#F1F1F1" height="40.9766" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="198" x="226" y="235"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="111" x="231" y="250.5352">total_null_rows</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="383" y="250.5352">0</text><line style="stroke:#000000;stroke-width:1.0;" x1="378" x2="378" y1="235" y2="255.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="226" x2="424" y1="255.4883" y2="255.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="142" x="231" y="271.0234">total_not_null_rows</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="383" y="271.0234">1596</text><line style="stroke:#000000;stroke-width:1.0;" x1="378" x2="378" y1="255.4883" y2="275.9766"/><rect fill="none" height="40.9766" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="198" x="226" y="235"/><rect fill="#F1F1F1" height="204.8828" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="22" x="313" y="294"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="309.5352">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="314.4883" y2="314.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="330.0234">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="334.9766" y2="334.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="350.5117">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="355.4648" y2="355.4648"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="371">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="375.9531" y2="375.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="391.4883">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="396.4414" y2="396.4414"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="411.9766">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="416.9297" y2="416.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="432.4648">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="437.418" y2="437.418"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="452.9531">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="457.9063" y2="457.9063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="473.4414">   </text><line style="stroke:#000000;stroke-width:1.0;" x1="313" x2="335" y1="478.3945" y2="478.3945"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="12" x="318" y="493.9297">   </text><rect fill="none" height="204.8828" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="22" x="313" y="294"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="3168" x="10871.5" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="10876.5" y="25.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="2742" x="10980.5" y="25.5352">CREATE FUNCTION [dbo].[ufnGetPurchaseOrderStatusText](@Status [tinyint])&#13;
RETURNS [nvarchar](15) &#13;
AS &#13;
-- Returns the sales order status text representation for the status value.&#13;
BEGIN&#13;
    DECLARE @ret [nvarchar](15);&#13;
&#13;
    SET @ret = &#13;
        CASE @Status&#13;
            WHEN 1 THEN 'Pending'&#13;
            WHEN 2 THEN 'Approved'&#13;
            WHEN 3 THEN 'Rejected'&#13;
            WHEN 4 THEN 'Complete'&#13;
            ELSE '</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="49" x="13727.5" y="25.5352">Invalid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="253" x="13781.5" y="25.5352">'&#13;
        END;&#13;
    &#13;
    RETURN @ret&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="10975.5" x2="10975.5" y1="10" y2="30.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="10871.5" x2="14039.5" y1="30.4883" y2="30.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="10876.5" y="46.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="10980.5" y="46.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="10975.5" x2="10975.5" y1="30.4883" y2="50.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="10871.5" x2="14039.5" y1="50.9766" y2="50.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="10876.5" y="66.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="10980.5" y="66.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="10975.5" x2="10975.5" y1="50.9766" y2="71.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="3168" x="10871.5" y="10"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="4518" x="10196.5" y="89"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="10201.5" y="104.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4404" x="10305.5" y="104.5352">CREATE FUNCTION [dbo].[ufnGetProductStandardCost](@ProductID [int], @OrderDate [datetime])&#13;
RETURNS [money] &#13;
AS &#13;
-- Returns the standard cost for the product on a specific date.&#13;
BEGIN&#13;
    DECLARE @StandardCost money;&#13;
&#13;
    SELECT @StandardCost = pch.[StandardCost] &#13;
    FROM [Production].[Product] p &#13;
        INNER JOIN [Production].[ProductCostHistory] pch &#13;
        ON p.[ProductID] = pch.[ProductID] &#13;
            AND p.[ProductID] = @ProductID &#13;
            AND @OrderDate BETWEEN pch.[StartDate] AND COALESCE(pch.[EndDate], CONVERT(datetime, '99991231', 112)); -- Make sure we get all the prices!&#13;
&#13;
    RETURN @StandardCost;&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="10300.5" x2="10300.5" y1="89" y2="109.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="10196.5" x2="14714.5" y1="109.4883" y2="109.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="10201.5" y="125.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="10305.5" y="125.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="10300.5" x2="10300.5" y1="109.4883" y2="129.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="10196.5" x2="14714.5" y1="129.9766" y2="129.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="10201.5" y="145.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="10305.5" y="145.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="10300.5" x2="10300.5" y1="129.9766" y2="150.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="4518" x="10196.5" y="89"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="3949" x="10481" y="168"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="10486" y="183.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="3835" x="10590" y="183.5352">CREATE FUNCTION [dbo].[ufnGetProductListPrice](@ProductID [int], @OrderDate [datetime])&#13;
RETURNS [money] &#13;
AS &#13;
BEGIN&#13;
    DECLARE @ListPrice money;&#13;
&#13;
    SELECT @ListPrice = plph.[ListPrice] &#13;
    FROM [Production].[Product] p &#13;
        INNER JOIN [Production].[ProductListPriceHistory] plph &#13;
        ON p.[ProductID] = plph.[ProductID] &#13;
            AND p.[ProductID] = @ProductID &#13;
            AND @OrderDate BETWEEN plph.[StartDate] AND COALESCE(plph.[EndDate], CONVERT(datetime, '99991231', 112)); -- Make sure we get all the prices!&#13;
&#13;
    RETURN @ListPrice;&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="10585" x2="10585" y1="168" y2="188.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="10481" x2="14430" y1="188.4883" y2="188.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="10486" y="204.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="10590" y="204.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="10585" x2="10585" y1="188.4883" y2="208.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="10481" x2="14430" y1="208.9766" y2="208.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="10486" y="224.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="10590" y="224.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="10585" x2="10585" y1="208.9766" y2="229.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="3949" x="10481" y="168"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="3017" x="10947" y="247"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="10952" y="262.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="2591" x="11056" y="262.5352">CREATE FUNCTION [dbo].[ufnGetDocumentStatusText](@Status [tinyint])&#13;
RETURNS [nvarchar](16) &#13;
AS &#13;
-- Returns the sales order status text representation for the status value.&#13;
BEGIN&#13;
    DECLARE @ret [nvarchar](16);&#13;
&#13;
    SET @ret = &#13;
        CASE @Status&#13;
            WHEN 1 THEN N'Pending approval'&#13;
            WHEN 2 THEN N'Approved'&#13;
            WHEN 3 THEN N'Obsolete'&#13;
            ELSE N'</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="49" x="13652" y="262.5352">Invalid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="253" x="13706" y="262.5352">'&#13;
        END;&#13;
    &#13;
    RETURN @ret&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="11051" x2="11051" y1="247" y2="267.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="10947" x2="13964" y1="267.4883" y2="267.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="10952" y="283.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="11056" y="283.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="11051" x2="11051" y1="267.4883" y2="287.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="10947" x2="13964" y1="287.9766" y2="287.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="10952" y="303.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="11056" y="303.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="11051" x2="11051" y1="287.9766" y2="308.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="3017" x="10947" y="247"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="23989" x="461" y="326"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="466" y="341.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1741" x="570" y="341.5352">CREATE FUNCTION [dbo].[ufnGetContactInformation](@PersonID int)&#13;
RETURNS @retContactInformation TABLE &#13;
(&#13;
    -- Columns returned by the function&#13;
    [PersonID] int NOT NULL, &#13;
    [FirstName] [nvarchar](50) NULL, &#13;
    [LastName] [nvarchar](50) NULL,</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1813" x="2330" y="341.5352">[JobTitle] [nvarchar](50) NULL,&#13;
    [BusinessEntityType] [nvarchar](50) NULL&#13;
)&#13;
AS &#13;
-- Returns the first name, last name, job title and business entity type for the specified contact.&#13;
-- Since a contact can serve multiple roles, more than one row may be returned.&#13;
BEGIN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="4154" y="341.5352">IF @PersonID IS NOT NULL</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="4378" y="341.5352">BEGIN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="397" x="4474" y="341.5352">IF EXISTS(SELECT * FROM [HumanResources].[Employee] e</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="281" x="5018" y="341.5352">WHERE e.[BusinessEntityID] = @PersonID)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="5402" y="341.5352">INSERT INTO @retContactInformation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="466" x="5786" y="341.5352">SELECT @PersonID, p.FirstName, p.LastName, e.[JobTitle], 'Employee'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="287" x="6362" y="341.5352">FROM [HumanResources].[Employee] AS e</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="6810" y="341.5352">INNER JOIN [Person].[Person] p</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="311" x="7162" y="341.5352">ON p.[BusinessEntityID] = e.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="280" x="7578" y="341.5352">WHERE e.[BusinessEntityID] = @PersonID;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="359" x="7930" y="341.5352">IF EXISTS(SELECT * FROM [Purchasing].[Vendor] AS v</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="8442" y="341.5352">INNER JOIN [Person].[BusinessEntityContact] bec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325" x="8922" y="341.5352">ON bec.[BusinessEntityID] = v.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="9402" y="341.5352">WHERE bec.[PersonID] = @PersonID)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="9722" y="341.5352">INSERT INTO @retContactInformation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="498" x="10106" y="341.5352">SELECT @PersonID, p.FirstName, p.LastName, ct.[Name], 'Vendor Contact'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="227" x="10714" y="341.5352">FROM [Purchasing].[Vendor] AS v</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="11098" y="341.5352">INNER JOIN [Person].[BusinessEntityContact] bec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325" x="11578" y="341.5352">ON bec.[BusinessEntityID] = v.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="241" x="12058" y="341.5352">INNER JOIN [Person].ContactType ct</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="12442" y="341.5352">ON ct.[ContactTypeID] = bec.[ContactTypeID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="12890" y="341.5352">INNER JOIN [Person].[Person] p</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="13242" y="341.5352">ON p.[BusinessEntityID] = bec.[PersonID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="246" x="13626" y="341.5352">WHERE bec.[PersonID] = @PersonID;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="0" x="13914" y="341.5352"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="304" x="13978" y="341.5352">IF EXISTS(SELECT * FROM [Sales].[Store] AS s</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="14426" y="341.5352">INNER JOIN [Person].[BusinessEntityContact] bec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325" x="14906" y="341.5352">ON bec.[BusinessEntityID] = s.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="247" x="15386" y="341.5352">WHERE bec.[PersonID] = @PersonID)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="15706" y="341.5352">INSERT INTO @retContactInformation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="484" x="16090" y="341.5352">SELECT @PersonID, p.FirstName, p.LastName, ct.[Name], 'Store Contact'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="16698" y="341.5352">FROM [Sales].[Store] AS s</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="327" x="17018" y="341.5352">INNER JOIN [Person].[BusinessEntityContact] bec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="325" x="17498" y="341.5352">ON bec.[BusinessEntityID] = s.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="241" x="17978" y="341.5352">INNER JOIN [Person].ContactType ct</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="308" x="18362" y="341.5352">ON ct.[ContactTypeID] = bec.[ContactTypeID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="18810" y="341.5352">INNER JOIN [Person].[Person] p</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="277" x="19162" y="341.5352">ON p.[BusinessEntityID] = bec.[PersonID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="246" x="19546" y="341.5352">WHERE bec.[PersonID] = @PersonID;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="329" x="19866" y="341.5352">IF EXISTS(SELECT * FROM [Person].[Person] AS p</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="237" x="20346" y="341.5352">INNER JOIN [Sales].[Customer] AS c</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="20730" y="341.5352">ON c.[PersonID] = p.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="445" x="21146" y="341.5352">WHERE p.[BusinessEntityID] = @PersonID AND c.[StoreID] IS NULL)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="255" x="21690" y="341.5352">INSERT INTO @retContactInformation</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="431" x="22074" y="341.5352">SELECT @PersonID, p.FirstName, p.LastName, NULL, 'Consumer'</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="197" x="22618" y="341.5352">FROM [Person].[Person] AS p</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="237" x="22970" y="341.5352">INNER JOIN [Sales].[Customer] AS c</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="260" x="23354" y="341.5352">ON c.[PersonID] = p.[BusinessEntityID]</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="444" x="23770" y="341.5352">WHERE p.[BusinessEntityID] = @PersonID AND c.[StoreID] IS NULL;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="24282" y="341.5352">END</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="24346" y="341.5352">RETURN;&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="565" x2="565" y1="326" y2="346.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="24450" y1="346.4883" y2="346.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="466" y="362.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="570" y="362.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="565" x2="565" y1="346.4883" y2="366.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="461" x2="24450" y1="366.9766" y2="366.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="466" y="382.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="570" y="382.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="565" x2="565" y1="366.9766" y2="387.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="23989" x="461" y="326"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="1107" x="11902" y="405"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="11907" y="420.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="993" x="12011" y="420.5352">CREATE FUNCTION [dbo].[ufnGetAccountingStartDate]()&#13;
RETURNS [datetime] &#13;
AS &#13;
BEGIN&#13;
    RETURN CONVERT(datetime, '20030701', 112);&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="12006" x2="12006" y1="405" y2="425.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="11902" x2="13009" y1="425.4883" y2="425.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="11907" y="441.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="12011" y="441.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="12006" x2="12006" y1="425.4883" y2="445.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="11902" x2="13009" y1="445.9766" y2="445.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="11907" y="461.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="12011" y="461.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="12006" x2="12006" y1="445.9766" y2="466.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1107" x="11902" y="405"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="1289" x="11811" y="484"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="11816" y="499.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="1175" x="11920" y="499.5352">CREATE FUNCTION [dbo].[ufnGetAccountingEndDate]()&#13;
RETURNS [datetime] &#13;
AS &#13;
BEGIN&#13;
    RETURN DATEADD(millisecond, -2, CONVERT(datetime, '20040701', 112));&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="11915" x2="11915" y1="484" y2="504.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="11811" x2="13100" y1="504.4883" y2="504.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="11816" y="520.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="11920" y="520.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="11915" x2="11915" y1="504.4883" y2="524.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="11811" x2="13100" y1="524.9766" y2="524.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="11816" y="540.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="11920" y="540.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="11915" x2="11915" y1="524.9766" y2="545.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="1289" x="11811" y="484"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="15806" x="4552.5" y="563"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="4557.5" y="578.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="15692" x="4661.5" y="578.5352">--A stored procedure which demonstrates integrated full text search&#13;
&#13;
CREATE PROCEDURE [dbo].[uspSearchCandidateResumes]&#13;
    @searchString [nvarchar](1000),   &#13;
    @useInflectional [bit]=0,&#13;
    @useThesaurus [bit]=0,&#13;
    @language[int]=0&#13;
&#13;
&#13;
WITH EXECUTE AS CALLER&#13;
AS&#13;
BEGIN&#13;
    SET NOCOUNT ON;&#13;
&#13;
      DECLARE @string nvarchar(1050)&#13;
      --setting the lcid to the default instance LCID if needed&#13;
      IF @language = NULL OR @language = 0 &#13;
      BEGIN &#13;
            SELECT @language =CONVERT(int, serverproperty('lcid'))  &#13;
      END&#13;
      &#13;
&#13;
            --FREETEXTTABLE case as inflectional and Thesaurus were required&#13;
      IF @useThesaurus = 1 AND @useInflectional = 1  &#13;
        BEGIN&#13;
                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL &#13;
                        INNER JOIN FREETEXTTABLE([HumanResources].[JobCandidate],*, @searchString,LANGUAGE @language) AS KEY_TBL&#13;
                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]&#13;
            END&#13;
&#13;
      ELSE IF @useThesaurus = 1&#13;
            BEGIN&#13;
                  SELECT @string ='FORMSOF(THESAURUS,"'+@searchString +'"'+')'      &#13;
                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL &#13;
                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*, @string,LANGUAGE @language) AS KEY_TBL&#13;
                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]&#13;
        END&#13;
&#13;
      ELSE IF @useInflectional = 1&#13;
            BEGIN&#13;
                  SELECT @string ='FORMSOF(INFLECTIONAL,"'+@searchString +'"'+')'&#13;
                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL &#13;
                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*, @string,LANGUAGE @language) AS KEY_TBL&#13;
                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]&#13;
        END&#13;
  &#13;
      ELSE --base case, plain CONTAINSTABLE&#13;
            BEGIN&#13;
                  SELECT @string='"'+@searchString +'"'&#13;
                  SELECT FT_TBL.[JobCandidateID],KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL &#13;
                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*,@string,LANGUAGE @language) AS KEY_TBL&#13;
                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]&#13;
            END&#13;
&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="4656.5" x2="4656.5" y1="563" y2="583.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="4552.5" x2="20358.5" y1="583.4883" y2="583.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="4557.5" y="599.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="4661.5" y="599.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="4656.5" x2="4656.5" y1="583.4883" y2="603.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="4552.5" x2="20358.5" y1="603.9766" y2="603.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="4557.5" y="619.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="4661.5" y="619.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="4656.5" x2="4656.5" y1="603.9766" y2="624.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="15806" x="4552.5" y="563"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="5213" x="9849" y="642"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="9854" y="657.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="5099" x="9958" y="657.5352">CREATE FUNCTION [dbo].[ufnGetProductDealerPrice](@ProductID [int], @OrderDate [datetime])&#13;
RETURNS [money] &#13;
AS &#13;
-- Returns the dealer price for the product on a specific date.&#13;
BEGIN&#13;
    DECLARE @DealerPrice money;&#13;
    DECLARE @DealerDiscount money;&#13;
&#13;
    SET @DealerDiscount = 0.60  -- 60% of list price&#13;
&#13;
    SELECT @DealerPrice = plph.[ListPrice] * @DealerDiscount &#13;
    FROM [Production].[Product] p &#13;
        INNER JOIN [Production].[ProductListPriceHistory] plph &#13;
        ON p.[ProductID] = plph.[ProductID] &#13;
            AND p.[ProductID] = @ProductID &#13;
            AND @OrderDate BETWEEN plph.[StartDate] AND COALESCE(plph.[EndDate], CONVERT(datetime, '99991231', 112)); -- Make sure we get all the prices!&#13;
&#13;
    RETURN @DealerPrice;&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="9953" x2="9953" y1="642" y2="662.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="9849" x2="15062" y1="662.4883" y2="662.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="9854" y="678.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="9958" y="678.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="9953" x2="9953" y1="662.4883" y2="682.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="9849" x2="15062" y1="682.9766" y2="682.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="9854" y="698.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="9958" y="698.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="9953" x2="9953" y1="682.9766" y2="703.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="5213" x="9849" y="642"/><rect fill="#F1F1F1" height="61.4648" rx="5" ry="5" style="stroke:#F1F1F1;stroke-width:1.5;" width="4983" x="9964" y="721"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="78" x="9969" y="736.5352">field_value</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="4869" x="10073" y="736.5352">-- uspPrintError prints error information about the error that caused &#13;
-- execution to jump to the CATCH block of a TRY...CATCH construct. &#13;
-- Should be executed from within the scope of a CATCH block otherwise &#13;
-- it will return without printing any error information.&#13;
CREATE PROCEDURE [dbo].[uspPrintError] &#13;
AS&#13;
BEGIN&#13;
    SET NOCOUNT ON;&#13;
&#13;
    -- Print error information. &#13;
    PRINT 'Error ' + CONVERT(varchar(50), ERROR_NUMBER()) +&#13;
          ', Severity ' + CONVERT(varchar(5), ERROR_SEVERITY()) +&#13;
          ', State ' + CONVERT(varchar(5), ERROR_STATE()) + &#13;
          ', Procedure ' + ISNULL(ERROR_PROCEDURE(), '-') + &#13;
          ', Line ' + CONVERT(varchar(5), ERROR_LINE());&#13;
    PRINT ERROR_MESSAGE();&#13;
END;</text><line style="stroke:#000000;stroke-width:1.0;" x1="10068" x2="10068" y1="721" y2="741.4883"/><line style="stroke:#000000;stroke-width:1.0;" x1="9964" x2="14947" y1="741.4883" y2="741.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74" x="9969" y="757.0234">row_count</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="9" x="10073" y="757.0234">1</text><line style="stroke:#000000;stroke-width:1.0;" x1="10068" x2="10068" y1="741.4883" y2="761.9766"/><line style="stroke:#000000;stroke-width:1.0;" x1="9964" x2="14947" y1="761.9766" y2="761.9766"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94" x="9969" y="777.5117">ratio_percent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="166" x="10073" y="777.5117">0.06265664160401002</text><line style="stroke:#000000;stroke-width:1.0;" x1="10068" x2="10068" y1="761.9766" y2="782.4648"/><rect fill="none" height="61.4648" rx="5" ry="5" style="stroke:#000000;stroke-width:1.5;" width="4983" x="9964" y="721"/><path d="M177,315.5 L190,315.5 C210.8273,315.5 207.6745,295.3971 226,285.5 C230.2321,283.2144 234.6626,281.0778 239.2032,279.0842 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M240.4096,281.9694 L241.3671,278.1794 L237.9968,276.199 L246.4162,276.0682 L240.4096,281.9694 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="177" cy="315.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,303.5 L338.5,303.5 C377.768,303.5 397.6833,313.7095 425,285.5 C489.6556,218.7312 389.9443,139.4125 461,79.5 C559.1161,-3.2291 7624.959,18.3652 10864.2128,32.6413 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M10864.1992,35.7251 L10866.5256,32.6515 L10864.2264,29.5575 L10871.9223,32.6753 L10864.1992,35.7251 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="303.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,324.5 L338.5,324.5 C380.6713,324.5 397.4563,317.4338 425,285.5 C463.3185,241.074 414.2566,193.9546 461,158.5 C556.6172,85.975 6739.3978,97.7057 10189.097,109.9339 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M10189.0862,112.9664 L10191.3713,109.942 L10189.1077,106.9015 L10196.678,109.9608 L10189.0862,112.9664 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="324.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,344.5 L338.5,344.5 C385.0358,344.5 391.3638,317.6588 425,285.5 C444.2747,267.0719 437.168,249.4645 461,237.5 C681.0022,127.0514 7123.8863,158.527 10473.6588,182.496 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M10473.6368,185.563 L10475.959,182.5125 L10473.6808,179.429 L10481.3263,182.5509 L10473.6368,185.563 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="344.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,365.5 L338.5,365.5 C396.9749,365.5 403.5598,328.4512 461,317.5 C965.8763,221.2438 7827.845,249.6811 10939.6091,267.7191 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M10939.5913,270.7954 L10941.9163,267.7325 L10939.627,264.6428 L10947.2999,267.7637 L10939.5913,270.7954 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="365.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,385.5 L338.5,385.5 C376.8634,385.5 415.295,385.4985 453.7921,385.4956 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M453.7924,388.5757 L456.1022,385.4954 L453.7919,382.4155 L461.4924,385.495 L453.7924,388.5757 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="385.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,406.5 L338.5,406.5 C4794.151,406.5 10171.429,426.3531 11894.9328,433.2064 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M11894.9208,436.231 L11897.2013,433.2154 L11894.9449,430.1818 L11902.4943,433.2365 L11894.9208,436.231 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="406.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,427.5 L338.5,427.5 C396.9749,427.5 403.5593,464.5512 461,475.5 C1020.408,582.1287 9384.2035,534.9847 11803.8715,519.0263 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M11803.8913,522.0345 L11806.1276,519.0114 L11803.8516,516.0181 L11811.392,518.9767 L11803.8913,522.0345 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="427.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,447.5 L338.5,447.5 C410.7892,447.5 393.3602,528.9933 461,554.5 C580.7175,599.645 2377.3469,615.8676 4545.2641,618.724 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M4545.2602,621.745 L4547.5298,618.727 L4545.2681,615.703 L4552.8166,618.7339 L4545.2602,621.745 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="447.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,468.5 L338.5,468.5 C429.8344,468.5 379.4745,592.3228 461,633.5 C667.5987,737.8497 6375.7416,716.0358 9841.7443,692.9913 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M9841.7646,696.0384 L9844.0296,692.9761 L9841.724,689.9442 L9849.362,692.9406 L9841.7646,696.0384 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="468.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M325.5,488.5 L338.5,488.5 C451.9703,488.5 363.4896,654.4722 461,712.5 C561.8345,772.5059 6471.4336,767.3279 9956.6278,759.0224 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M9956.6351,762.0862 L9958.9257,759.0169 L9956.6205,755.9585 L9964.2874,759.0041 L9956.6351,762.0862 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="325.5" cy="488.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><path d="M177,336.5 L190,336.5 C235.3406,336.5 282.4028,365.289 307.0463,382.9834 " fill="none" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:3.0,3.0;"/><path d="M305.181,385.5179 L308.9472,384.3824 L308.9117,380.4489 L313.3825,387.6468 L305.181,385.5179 " fill="#000000" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="177" cy="336.5" fill="#000000" rx="3" ry="3" style="stroke:#000000;stroke-width:1.0;"/><!--MD5=[1f152a552c66fb44fb0af4bbe787ab81]
@startjson
{
    "field1": "TSQL",
    "combination": "TSQL",
    "null_distribution": {
        "total_null_rows": 0,
        "total_not_null_rows": 1596
    },
    "data_distribution": [
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetPurchaseOrderStatusText](@Status [tinyint])\r\nRETURNS [nvarchar](15) \r\nAS \r\n- - Returns the sales order status text representation for the status value.\r\nBEGIN\r\n    DECLARE @ret [nvarchar](15);\r\n\r\n    SET @ret = \r\n        CASE @Status\r\n            WHEN 1 THEN 'Pending'\r\n            WHEN 2 THEN 'Approved'\r\n            WHEN 3 THEN 'Rejected'\r\n            WHEN 4 THEN 'Complete'\r\n            ELSE '** Invalid **'\r\n        END;\r\n    \r\n    RETURN @ret\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetProductStandardCost](@ProductID [int], @OrderDate [datetime])\r\nRETURNS [money] \r\nAS \r\n- - Returns the standard cost for the product on a specific date.\r\nBEGIN\r\n    DECLARE @StandardCost money;\r\n\r\n    SELECT @StandardCost = pch.[StandardCost] \r\n    FROM [Production].[Product] p \r\n        INNER JOIN [Production].[ProductCostHistory] pch \r\n        ON p.[ProductID] = pch.[ProductID] \r\n            AND p.[ProductID] = @ProductID \r\n            AND @OrderDate BETWEEN pch.[StartDate] AND COALESCE(pch.[EndDate], CONVERT(datetime, '99991231', 112)); - - Make sure we get all the prices!\r\n\r\n    RETURN @StandardCost;\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetProductListPrice](@ProductID [int], @OrderDate [datetime])\r\nRETURNS [money] \r\nAS \r\nBEGIN\r\n    DECLARE @ListPrice money;\r\n\r\n    SELECT @ListPrice = plph.[ListPrice] \r\n    FROM [Production].[Product] p \r\n        INNER JOIN [Production].[ProductListPriceHistory] plph \r\n        ON p.[ProductID] = plph.[ProductID] \r\n            AND p.[ProductID] = @ProductID \r\n            AND @OrderDate BETWEEN plph.[StartDate] AND COALESCE(plph.[EndDate], CONVERT(datetime, '99991231', 112)); - - Make sure we get all the prices!\r\n\r\n    RETURN @ListPrice;\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetDocumentStatusText](@Status [tinyint])\r\nRETURNS [nvarchar](16) \r\nAS \r\n- - Returns the sales order status text representation for the status value.\r\nBEGIN\r\n    DECLARE @ret [nvarchar](16);\r\n\r\n    SET @ret = \r\n        CASE @Status\r\n            WHEN 1 THEN N'Pending approval'\r\n            WHEN 2 THEN N'Approved'\r\n            WHEN 3 THEN N'Obsolete'\r\n            ELSE N'** Invalid **'\r\n        END;\r\n    \r\n    RETURN @ret\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetContactInformation](@PersonID int)\r\nRETURNS @retContactInformation TABLE \r\n(\r\n    - - Columns returned by the function\r\n    [PersonID] int NOT NULL, \r\n    [FirstName] [nvarchar](50) NULL, \r\n    [LastName] [nvarchar](50) NULL, \r\n\t[JobTitle] [nvarchar](50) NULL,\r\n    [BusinessEntityType] [nvarchar](50) NULL\r\n)\r\nAS \r\n- - Returns the first name, last name, job title and business entity type for the specified contact.\r\n- - Since a contact can serve multiple roles, more than one row may be returned.\r\nBEGIN\r\n\tIF @PersonID IS NOT NULL \r\n\t\tBEGIN\r\n\t\tIF EXISTS(SELECT * FROM [HumanResources].[Employee] e \r\n\t\t\t\t\tWHERE e.[BusinessEntityID] = @PersonID) \r\n\t\t\tINSERT INTO @retContactInformation\r\n\t\t\t\tSELECT @PersonID, p.FirstName, p.LastName, e.[JobTitle], 'Employee'\r\n\t\t\t\tFROM [HumanResources].[Employee] AS e\r\n\t\t\t\t\tINNER JOIN [Person].[Person] p\r\n\t\t\t\t\tON p.[BusinessEntityID] = e.[BusinessEntityID]\r\n\t\t\t\tWHERE e.[BusinessEntityID] = @PersonID;\r\n\r\n\t\tIF EXISTS(SELECT * FROM [Purchasing].[Vendor] AS v\r\n\t\t\t\t\tINNER JOIN [Person].[BusinessEntityContact] bec \r\n\t\t\t\t\tON bec.[BusinessEntityID] = v.[BusinessEntityID]\r\n\t\t\t\t\tWHERE bec.[PersonID] = @PersonID)\r\n\t\t\tINSERT INTO @retContactInformation\r\n\t\t\t\tSELECT @PersonID, p.FirstName, p.LastName, ct.[Name], 'Vendor Contact' \r\n\t\t\t\tFROM [Purchasing].[Vendor] AS v\r\n\t\t\t\t\tINNER JOIN [Person].[BusinessEntityContact] bec \r\n\t\t\t\t\tON bec.[BusinessEntityID] = v.[BusinessEntityID]\r\n\t\t\t\t\tINNER JOIN [Person].ContactType ct\r\n\t\t\t\t\tON ct.[ContactTypeID] = bec.[ContactTypeID]\r\n\t\t\t\t\tINNER JOIN [Person].[Person] p\r\n\t\t\t\t\tON p.[BusinessEntityID] = bec.[PersonID]\r\n\t\t\t\tWHERE bec.[PersonID] = @PersonID;\r\n\t\t\r\n\t\tIF EXISTS(SELECT * FROM [Sales].[Store] AS s\r\n\t\t\t\t\tINNER JOIN [Person].[BusinessEntityContact] bec \r\n\t\t\t\t\tON bec.[BusinessEntityID] = s.[BusinessEntityID]\r\n\t\t\t\t\tWHERE bec.[PersonID] = @PersonID)\r\n\t\t\tINSERT INTO @retContactInformation\r\n\t\t\t\tSELECT @PersonID, p.FirstName, p.LastName, ct.[Name], 'Store Contact' \r\n\t\t\t\tFROM [Sales].[Store] AS s\r\n\t\t\t\t\tINNER JOIN [Person].[BusinessEntityContact] bec \r\n\t\t\t\t\tON bec.[BusinessEntityID] = s.[BusinessEntityID]\r\n\t\t\t\t\tINNER JOIN [Person].ContactType ct\r\n\t\t\t\t\tON ct.[ContactTypeID] = bec.[ContactTypeID]\r\n\t\t\t\t\tINNER JOIN [Person].[Person] p\r\n\t\t\t\t\tON p.[BusinessEntityID] = bec.[PersonID]\r\n\t\t\t\tWHERE bec.[PersonID] = @PersonID;\r\n\r\n\t\tIF EXISTS(SELECT * FROM [Person].[Person] AS p\r\n\t\t\t\t\tINNER JOIN [Sales].[Customer] AS c\r\n\t\t\t\t\tON c.[PersonID] = p.[BusinessEntityID]\r\n\t\t\t\t\tWHERE p.[BusinessEntityID] = @PersonID AND c.[StoreID] IS NULL) \r\n\t\t\tINSERT INTO @retContactInformation\r\n\t\t\t\tSELECT @PersonID, p.FirstName, p.LastName, NULL, 'Consumer' \r\n\t\t\t\tFROM [Person].[Person] AS p\r\n\t\t\t\t\tINNER JOIN [Sales].[Customer] AS c\r\n\t\t\t\t\tON c.[PersonID] = p.[BusinessEntityID]\r\n\t\t\t\t\tWHERE p.[BusinessEntityID] = @PersonID AND c.[StoreID] IS NULL; \r\n\t\tEND\r\n\r\n\tRETURN;\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetAccountingStartDate]()\r\nRETURNS [datetime] \r\nAS \r\nBEGIN\r\n    RETURN CONVERT(datetime, '20030701', 112);\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetAccountingEndDate]()\r\nRETURNS [datetime] \r\nAS \r\nBEGIN\r\n    RETURN DATEADD(millisecond, -2, CONVERT(datetime, '20040701', 112));\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "- -A stored procedure which demonstrates integrated full text search\r\n\r\nCREATE PROCEDURE [dbo].[uspSearchCandidateResumes]\r\n    @searchString [nvarchar](1000),   \r\n    @useInflectional [bit]=0,\r\n    @useThesaurus [bit]=0,\r\n    @language[int]=0\r\n\r\n\r\nWITH EXECUTE AS CALLER\r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n\r\n      DECLARE @string nvarchar(1050)\r\n      - -setting the lcid to the default instance LCID if needed\r\n      IF @language = NULL OR @language = 0 \r\n      BEGIN \r\n            SELECT @language =CONVERT(int, serverproperty('lcid'))  \r\n      END\r\n      \r\n\r\n            - -FREETEXTTABLE case as inflectional and Thesaurus were required\r\n      IF @useThesaurus = 1 AND @useInflectional = 1  \r\n        BEGIN\r\n                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL \r\n                        INNER JOIN FREETEXTTABLE([HumanResources].[JobCandidate],*, @searchString,LANGUAGE @language) AS KEY_TBL\r\n                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]\r\n            END\r\n\r\n      ELSE IF @useThesaurus = 1\r\n            BEGIN\r\n                  SELECT @string ='FORMSOF(THESAURUS,\"'+@searchString +'\"'+')'      \r\n                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL \r\n                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*, @string,LANGUAGE @language) AS KEY_TBL\r\n                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]\r\n        END\r\n\r\n      ELSE IF @useInflectional = 1\r\n            BEGIN\r\n                  SELECT @string ='FORMSOF(INFLECTIONAL,\"'+@searchString +'\"'+')'\r\n                  SELECT FT_TBL.[JobCandidateID], KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL \r\n                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*, @string,LANGUAGE @language) AS KEY_TBL\r\n                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]\r\n        END\r\n  \r\n      ELSE - -base case, plain CONTAINSTABLE\r\n            BEGIN\r\n                  SELECT @string='\"'+@searchString +'\"'\r\n                  SELECT FT_TBL.[JobCandidateID],KEY_TBL.[RANK] FROM [HumanResources].[JobCandidate] AS FT_TBL \r\n                        INNER JOIN CONTAINSTABLE([HumanResources].[JobCandidate],*,@string,LANGUAGE @language) AS KEY_TBL\r\n                   ON  FT_TBL.[JobCandidateID] =KEY_TBL.[KEY]\r\n            END\r\n\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "CREATE FUNCTION [dbo].[ufnGetProductDealerPrice](@ProductID [int], @OrderDate [datetime])\r\nRETURNS [money] \r\nAS \r\n- - Returns the dealer price for the product on a specific date.\r\nBEGIN\r\n    DECLARE @DealerPrice money;\r\n    DECLARE @DealerDiscount money;\r\n\r\n    SET @DealerDiscount = 0.60  - - 60% of list price\r\n\r\n    SELECT @DealerPrice = plph.[ListPrice] * @DealerDiscount \r\n    FROM [Production].[Product] p \r\n        INNER JOIN [Production].[ProductListPriceHistory] plph \r\n        ON p.[ProductID] = plph.[ProductID] \r\n            AND p.[ProductID] = @ProductID \r\n            AND @OrderDate BETWEEN plph.[StartDate] AND COALESCE(plph.[EndDate], CONVERT(datetime, '99991231', 112)); - - Make sure we get all the prices!\r\n\r\n    RETURN @DealerPrice;\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        },
        {
            "field_value": "- - uspPrintError prints error information about the error that caused \r\n- - execution to jump to the CATCH block of a TRY...CATCH construct. \r\n- - Should be executed from within the scope of a CATCH block otherwise \r\n- - it will return without printing any error information.\r\nCREATE PROCEDURE [dbo].[uspPrintError] \r\nAS\r\nBEGIN\r\n    SET NOCOUNT ON;\r\n\r\n    - - Print error information. \r\n    PRINT 'Error ' + CONVERT(varchar(50), ERROR_NUMBER()) +\r\n          ', Severity ' + CONVERT(varchar(5), ERROR_SEVERITY()) +\r\n          ', State ' + CONVERT(varchar(5), ERROR_STATE()) + \r\n          ', Procedure ' + ISNULL(ERROR_PROCEDURE(), '-') + \r\n          ', Line ' + CONVERT(varchar(5), ERROR_LINE());\r\n    PRINT ERROR_MESSAGE();\r\nEND;",
            "row_count": 1,
            "ratio_percent": 0.06265664160401002
        }
    ]
}
@endjson

PlantUML version 1.2022.5(Sat Apr 30 06:55:52 EDT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: CA
--></g></svg>